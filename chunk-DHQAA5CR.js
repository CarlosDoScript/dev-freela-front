import{b as U}from"./chunk-GNNS6ZM6.js";import{a as A,b as D,c as k,d as G,e as w,f as V,g as L,h as z}from"./chunk-ATGHTU5J.js";import{b as S,d as f,f as y,g as b,i as _,k as F,l as M,m as O,n as B}from"./chunk-4PJ3TXTO.js";import{a as $}from"./chunk-4RZAZVH2.js";import{a as J,b as N,c as q,e as R}from"./chunk-LG2G5NZQ.js";import{$ as g,Fa as m,Ga as u,Ha as E,W as a,Z as c,Za as x,ab as P,d as H,da as l,gb as I,ha as p,ib as T,na as n,oa as i,pa as s,ta as j,ua as d,xa as h}from"./chunk-YW53WYO2.js";var C=H(J());function K(o,e){if(o&1&&(n(0,"mat-error"),m(1),i()),o&2){let t=d();a(),u(t.message.required)}}function Q(o,e){if(o&1&&(n(0,"mat-error"),m(1),i()),o&2){let t=d();a(),E(" ",t.message.required," ")}}function X(o,e){if(o&1&&(n(0,"mat-error"),m(1),i()),o&2){let t=d();a(),u(t.message.required)}}var W=class o{constructor(e,t,r,v,Y){this.fb=e;this.projectService=t;this.router=r;this.activateRoute=v;this.authService=Y;this.createEditProjectForm=this.fb.group({title:["",f.required],totalCost:[null,f.required],description:["",f.required]})}createEditProjectForm;createEditProject={title:"",totalCost:0,description:"",idClient:""};params={};screenType="create";messageTitleType="";messageButtonType="";message=L;ngOnInit(){this.getParams()}createOrEdit(){if(!this.createEditProjectForm.valid){this.createEditProjectForm.markAllAsTouched();return}let e=this.createEditProjectForm.value;e.idClient=this.authService.getUser().clientId??"",this.projectService.CreateEditProject(this.screenType,this.params,e).subscribe({next:t=>{let r=this.screenType==="edit"?"Editado com sucesso!":"Cadastrado com sucesso!";C.default.fire({title:"Bom Trabalho!",text:r,icon:"success",confirmButtonText:"Ok!"}).then(v=>{v.isConfirmed&&this.router.navigate(["project/list"])})},error:t=>{let r=this.screenType==="edit"?"alterar":"cadastrar";C.default.fire({title:"Erro!",text:`Falha ao ${r}. Tente novamente.`,icon:"error",confirmButtonText:"Ok"})}})}fillInputs(){this.screenType==="edit"&&this.projectService.GetByIdProject(this.params).subscribe({next:e=>{this.createEditProjectForm.patchValue({title:e.title,totalCost:e.totalCost,description:e.description})},error:e=>{C.default.fire({title:"Erro!",text:"Falha ao buscar projeto. Tente novamente.",icon:"error",confirmButtonText:"Ok"})}})}getParams(){this.activateRoute.queryParams.subscribe(e=>{this.params=e,this.screenType=this.params.id?"edit":"create",this.setScreenTypeTexts(),this.fillInputs()})}setScreenTypeTexts(){let e=this.screenTexts[this.screenType];e&&(this.messageTitleType=e.title,this.messageButtonType=e.button)}screenTexts={create:{title:"Vamos cadastrar seu novo projeto!",button:"Cadastrar"},edit:{title:"Editar projeto",button:"Salvar"}};isInvalid(e,t){let r=this.createEditProjectForm.get(e);return!!(r?.errors?.[t]&&r.touched)}static \u0275fac=function(t){return new(t||o)(c(O),c($),c(T),c(I),c(q))};static \u0275cmp=g({type:o,selectors:[["app-project-create-edit"]],decls:22,vars:6,consts:[[1,"ld-project-create-edit"],["back","project/list"],[1,"left",3,"ngSubmit","formGroup"],[1,"main-title"],["appearance","outline",1,"ld-input"],["matInput","","formControlName","title"],[4,"ngIf"],["appearance","outline"],["matInput","","type","text","formControlName","totalCost","mask","separator.2","thousandSeparator",".","decimalMarker",",","prefix","R$ ","inputMode","decimal","placeholder","Digite o valor"],["matInput","","formControlName","description"],[3,"text"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"app-ld-wrapper",1)(2,"form",2),j("ngSubmit",function(){return r.createOrEdit()}),n(3,"h1",3),m(4),i(),n(5,"mat-form-field",4)(6,"mat-label"),m(7,"T\xEDtulo"),i(),s(8,"input",5),l(9,K,2,1,"mat-error",6),i(),n(10,"mat-form-field",7)(11,"mat-label"),m(12,"Custo Total"),i(),s(13,"input",8),l(14,Q,2,1,"mat-error",6),i(),n(15,"mat-form-field",4)(16,"mat-label"),m(17,"Descri\xE7\xE3o"),i(),s(18,"textarea",9),l(19,X,2,1,"mat-error",6),i(),s(20,"app-ld-button",10),i(),s(21,"app-ld-bg-cubes"),i()()),t&2&&(a(2),p("formGroup",r.createEditProjectForm),a(2),u(r.messageTitleType),a(5),p("ngIf",r.isInvalid("title","required")),a(5),p("ngIf",r.isInvalid("totalCost","required")),a(5),p("ngIf",r.isInvalid("description","required")),a(),h("text",r.messageButtonType))},dependencies:[R,z,N,G,k,A,D,V,w,P,x,B,_,S,y,b,F,M,U],styles:[".ld-project-create-edit[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{max-width:368px;margin:auto}.ld-project-create-edit[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%] > .ld-button[_ngcontent-%COMP%]{margin-top:40px}.ld-project-create-edit[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%] > .main-title[_ngcontent-%COMP%]{font-size:calc(var(--ld-font-size-base) + 32px);font-weight:800;max-width:415px;margin-bottom:40px}"]})};export{W as ProjectCreateEditComponent};
